<!DOCTYPE html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link type="text/css" rel="stylesheet" href="__CSS__style.css" />
    
    <script type="text/javascript" src="__JS__jquery-1.11.1.min_044d0927.js"></script>
    <script type="text/javascript" src="__JS__jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="__JS__menu.js"></script>               
	<script type="text/javascript" src="__JS__n_nav.js"></script>   
    <script type="text/javascript" src="__JS__shade.js"></script>
    <script type="text/javascript" src="__JS__jquery-1.11.3.js"></script>
<title>我的购物车</title>
</head>
<body>  
<!--Begin Header Begin-->
{include file="common/indexHeader"}
<!--End Menu End--> 
<div class="i_bg">  
    <div class="content mar_20">
    	<img src="images/img1.jpg" />        
    </div>
    
    <!--Begin 第一步：查看购物车 Begin -->
    <div class="content mar_20">
      <form action="" method="post" enctype="multipart/form-data">
    	<table border="0" class="car_tab" style="width:1200px; margin-bottom:50px;" cellspacing="0" cellpadding="0">
          <tr>
            <td></td>
            <td class="car_th" width="250">商品名称</td>
            <td class="car_th" width="140">属性</td>
            <td class="car_th" width="150">购买数量</td>
            <td class="car_th" width="100">单价</td>
            <td class="car_th" width="130">小计</td>
            <td class="car_th" width="100">返还积分</td>
            <td class="car_th" width="200">操作</td>
          </tr> 
          {foreach $res_id as $vo}
          {foreach $good_res as $val}
          {if condition="$vo['goods_id'] eq $val['id']"}
          <tr>
          <td><input type="checkbox" name="good_id" value="{$val['id']}"></td>
            <td>
            	<div class="c_s_img"><a href="{:url('index/details',['good'=>$val['id']])}"><img src="{$val.picture|substr=1}" width="73" height="73" /></a></div>
                {$val['name']}
            </td>
            <td align="center">重量:200g</td>
            <td align="center">
            	<div class="c_num">
                    <input type="button" value="-" class="car_btn_1" id="sub" />
                    <input type="text" value="{$vo.number}" name="number[]" class="car_ipt" />  
                    <input type="button" value="+"  class="car_btn_2" />
                </div> 
            </td>
            <td align="center">{$val['price'] * $val['discount']}&nbsp;&nbsp;<span style="text-decoration:line-through; color:red;">{$val['price']}</span></td>
            <td align="center" style="color:#ff4e00;">
            <input type="text"  style="border:none; width:50px;height:20px;" name="money" value="{$val.price * $val.discount * $vo.number }">
            </td>
            <td align="center">26R</td>
            <td align="center"><a onclick="ShowDiv('MyDiv','fade')">删除</a>&nbsp; &nbsp;<a href="{:url('collect/collect',['good'=>$val['id']])}">加入收藏</a></td>
          </tr>
          {/if}
         {/foreach}
       {/foreach}
          <tr valign="top" height="150">
          	<td colspan="7" align="right">
            	<a href="{:url('index/index')}">继续购物</a>&nbsp; &nbsp; 
                <input type="button" id="shop" value="去结算">
            </td>
          </tr>
        </table> 
        </form>  
    </div>
	<!--End 第一步：查看购物车 End--> 
    
    
    <!--Begin 弹出层-删除商品 Begin-->
    <div id="fade" class="black_overlay"></div>
    <div id="MyDiv" class="white_content">             
        <div class="white_d">
            <div class="notice_t">
                <span class="fr" style="margin-top:10px; cursor:pointer;" onclick="CloseDiv('MyDiv','fade')"><img src="images/close.gif" /></span>
            </div>
            <div class="notice_c">
           		
                <table border="0" align="center" style="font-size:16px;" cellspacing="0" cellpadding="0">
                  <tr valign="top">
                    <td>您确定要把该商品移除购物车吗？</td>
                  </tr>
                  <tr height="50" valign="bottom">
                    <td><a href="#" class="b_sure">确定</a><a href="#" class="b_buy">取消</a></td>
                  </tr>
                </table>
                    
            </div>
        </div>
    </div>    
   {include file="common/indexFooter"}   
</div>
</body>
</html>
<script type="text/javascript">
    $(function() {

        //增加 点击—号时
         $(".car_btn_2").click(function() {
            //alert($(this).prev().val());
            var num =parseInt($(this).prev().val());
             num++;  
             $(this).prev().val(num);
             alert(num++);
            $.post("{:url('car/number')}",{number:num++},success)
            function success(data)
            {
              alert(data);
            }
          
          });

         //减少 最小为1 点击+时
          $(".car_btn_1").click(function() {
            var num =parseInt($(this).next().val());
            num--;
            if(num <=0) {
                num=1;
            }else {
                $.post('number',{number:num},success)
                function success()
                {
                    var data = JSON.parse(data);
                    alert(data);
                }
            }
            $(this).next().val(num);
          });


    });


</script>
